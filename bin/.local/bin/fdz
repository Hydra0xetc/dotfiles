#!/usr/bin/env bash

BASE="/data/data/com.termux/files/home"
DIR_REL=$(fd . "$BASE" --type d -L | sed "s|^$BASE|/home|" | fzf-tmux -p --border --height=40% --prompt="Select directory: ")

if [[ -z "$DIR_REL" ]]; then
  exit 0
fi

DIR="${DIR_REL/\/home/$BASE}"

SESSION_NAME=$(basename "$DIR")

if tmux has-session -t "$SESSION_NAME" 2>/dev/null; then
  tmux attach-session -t "$SESSION_NAME"
else
  tmux new-session -s "$SESSION_NAME" -c "$DIR"
fi
